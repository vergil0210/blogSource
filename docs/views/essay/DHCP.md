## 1. DHCP作用

（Dynamic Host Configuration Protocol)动态主机配制协议，是一个局域网的网络协议，用于自动获取服务器分配的IP地址的子网掩码。

## 2. DHCP相关概念

地址池/作用域：

## 3. DHCP优点

减少工作量、避免IP冲突、提高地址利用率、降低发生配置错误的可能性

## 4. DHCP原理

也称为DHCP租约过程，分为四个步骤

  1. 发送DHCP Discovery广播包

     客户机广播一个报文，该报文告知监听服务器客户端需要IP地址。（该报文包含租约请求、客户端源地址、广播地址、客户机的MAC地址及机器名）该网络上每台安装了TCP/IP协议的主机都会收到该广播，但是只有DHCP服务器会做出相应。

     注：MAC是具有全球唯一性的物理地址

  2. 响应DHCP Offer广播包

     所有拥有IP地址的DHCP服务器都会向DHCP客户端提供IP地址信息，它将地址池中一个未被分配的IP地址提供给主机使用。DHCP服务器回复的报文包含以下信息

     - 客户端的硬件地址
     - 提供的IP地址
     - 配套的子网掩码
     - 租约有效期
     - 服务器ID，即DHCP服务器的IP地址

  3. 客户机选择IP地址 （DHCP Request广播包）

     DHCP客户端选择它所接受到的**第一个**DHCPOFFER报文提供的IP地址。之后他把这个信息广播至网络。该报文包含客户端请求服务器给他的IP地址。通过此广播，客户端告知其他DHCP服务器不再接受他们的OFFER。为了进一步确保客户端接受的服务器OFFER没有存疑，DHCP Request报文包含以下信息：

     - 提供所接受offer的服务器IP地址
     - 客户端硬件地址
     - 客户端接受的IP地址

  4. 服务器确认租约（DHCP Ack）

     DHCP服务器对客户端做出相应，将IP地址分配给客户端并发送DHCP Ack确认信息给客户端。该信息包含IP的有效租约以及其他的配制信息。

## 5. 常用命令

ipconfig /release 释放租约

ipconfig /renew 重新申请ip地址/续约（取决于当前是否有租约）

## 6. 地址保留

对指定的MAC地址，固定分配IP地址

## 7. 选项优先级

作用域选项>服务器选项

当服务器上又多个作用域时，可以在服务器选项上设置DNS服务器。各作用域会继承服务器选项上的配制，通过设置作用域选项的配制可以将其覆盖。

## 8. 攻击与防御

